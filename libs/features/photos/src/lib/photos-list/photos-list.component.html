<div class="photos-viewport" #scrollContainer rxVirtualViewObserver>
  @if (isLoading() && photos().length === 0) {
    <div class="initial-loading">
      <lib-loading-spinner />
    </div>
  }

  @if (!isLoading() && photos().length === 0) {
    <div class="empty-state">
      <p>No photos available</p>
    </div>
  }

  @if (photos().length > 0) {
    <div class="photo-grid">
      @for (photo of photos(); track photo.id) {
        <div class="photo-item" rxVirtualView>
          <lib-photo-card-with-favorite
            *rxVirtualViewContent
            [photo]="enrichPhotoWithFavorite(photo)"
            (photoClick)="onPhotoClick(photo)"
            (toggleFavorite)="onToggleFavoriteForPhoto(photo)" />
          <div 
            *rxVirtualViewPlaceholder 
            class="photo-placeholder"
            [style.min-height.px]="290">
          </div>
        </div>
      }
    </div>

    @if (isLoading() && hasMore()) {
      <div class="loading-more">
        <lib-loading-spinner />
      </div>
    }
  }
</div>

@if (selectedPhoto()) {
  <lib-image-preview-modal
    [photo]="selectedPhoto()!"
    (close)="onClosePreview()"
    (toggleFavorite)="onToggleFavorite()" />
}
